---
/**
 * FAQ Component
 *
 * @description Reusable FAQ section with SEO schema markup and accessibility features
 */

import { Icon } from 'astro-icon/components'

interface FAQItem {
  question: string
  answer: string
}

interface Props {
  headline: string
  items: FAQItem[]
  class?: string
}

const { headline, items, class: className = '' } = Astro.props

// Generate FAQ Schema for SEO
const faqSchema = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: items.map((item) => ({
    '@type': 'Question',
    name: item.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: item.answer,
    },
  })),
}
---

<section id="faq" class={`bg-white py-20 ${className}`} aria-labelledby="faq-headline">
  <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
    <h2 id="faq-headline" class="mb-12 text-center text-3xl font-bold text-gray-900 sm:text-4xl">
      {headline}
    </h2>

    <div class="space-y-6">
      {
        items.map((item, index) => (
          <details
            class="group rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-all hover:shadow-md"
            open={index === 0}
          >
            <summary class="flex cursor-pointer items-center justify-between text-left">
              <h3 class="faq-question group-open:text-primary text-lg font-semibold text-gray-900">{item.question}</h3>
              <Icon
                name="lucide:chevron-down"
                class="h-5 w-5 flex-shrink-0 text-gray-400 transition-transform group-open:rotate-180"
                aria-hidden="true"
              />
            </summary>
            <div class="mt-4 leading-relaxed text-gray-600">{item.answer}</div>
          </details>
        ))
      }
    </div>
  </div>

  <!-- FAQ Schema for SEO -->
  <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
</section>

<style lang="scss">
  // FAQ section enhancements
  #faq {
    details {
      transition: all 0.2s ease-in-out;

      &[open] {
        box-shadow:
          0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        border-color: var(--color-primary-200);
      }

      summary {
        list-style: none;

        &::-webkit-details-marker {
          display: none;
        }

        &:hover h3 {
          color: var(--color-primary-600);
        }
      }

      h3 {
        transition: color 0.2s ease-in-out;
      }

      // FAQ questions use body font instead of heading font
      .faq-question {
        font-family: var(--font-body);
      }
    }
  }

  // Focus management for FAQ
  details summary:focus-visible {
    outline: 2px solid var(--color-primary-500);
    outline-offset: 4px;
    border-radius: var(--radius-s);
  }
</style>
